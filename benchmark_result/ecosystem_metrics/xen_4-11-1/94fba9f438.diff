From 94fba9f438a2c36ad9bf3a481a6013ddc7cf8cd9 Mon Sep 17 00:00:00 2001
From: Ian Jackson <ian.jackson@eu.citrix.com>
Date: Tue, 18 Sep 2018 11:25:20 +0100
Subject: [PATCH] stubdom/grub.patches: Drop docs changes, for licensing
 reasons

The patch file 00cvs is an import of a new upstream version of
grub1 from upstream CVS.

Unfortunately, in the period covered by the update, upstream changed
the documentation licence from a simple permissive licence, to the GNU
"Free Documentation Licence" with Front and Back Cover Texts.

The Debian Project is of the view that use the Front and Back Cover
Texts feature of the GFDL makes the resulting document not Free
Software, because of the mandatory redistribution of these immutable
texts.  (Personally, I agree.)

This is awkward because Debian do not want to ship non-free content.
So the Debian maintainers need to launder the upstream source code, to
remove the troublesome files.  This is an extra step when
incorporating new upstream versions.  It's particularly annoying for
security response, which often involves rebasing onto a new upstream
release.

grub1 is obsolete and the last change to Xen's PV grub1 stubdom code
was in 2016.  Furthermore, the grub1 documentation is not built and
installed by the Xen pv-grub stubdom Makefiles.

Therefore, remove all docs changes from stubdom/grub.patches.  This
means that there are now no longer any GFDL-licenced grub docs in
xen.git.

There is no user impact, and Debian is helped.  This change would
complicate any attempts to update to a new version of upstream grub1,
but it seems unlikely that such a thing will ever happen.

Signed-off-by: Ian Jackson <ian.jackson@eu.citrix.com>
CC: Doug Goldstein <cardoe@cardoe.com>
CC: Juergen Gross <jgross@suse.com>
CC: pkg-xen-devel@lists.alioth.debian.org
Acked-by: George Dunlap <george.dunlap@citrix.com>
Acked-by: Samuel Thibault <samuel.thibault@ens-lyon.org>
(cherry picked from commit c62c53d61477dfeb63a47b0673c389082112babc)
---
 stubdom/grub.patches/00cvs             | 360 -------------------------
 stubdom/grub.patches/20print_func.diff |  28 --
 stubdom/grub.patches/61btrfs.diff      |  11 -
 3 files changed, 399 deletions(-)

diff --git a/stubdom/grub.patches/00cvs b/stubdom/grub.patches/00cvs
index 79473067f2..47d66f3a3b 100644
--- a/stubdom/grub.patches/00cvs
+++ b/stubdom/grub.patches/00cvs
@@ -310,366 +310,6 @@ diff -uprN grub-0.97/configure.ac grub/configure.ac
  if test "x$with_binutils" != x; then
  dnl  AC_PATH_TOOL(OBJCOPY, objcopy, , "$with_binutils:$PATH")
    AC_PATH_PROG(OBJCOPY, objcopy, , "$with_binutils:$PATH")
-diff -uprN grub-0.97/docs/grub.8 grub/docs/grub.8
---- grub-0.97/docs/grub.8	2005-05-08 03:48:56.000000000 +0100
-+++ grub/docs/grub.8	2006-06-24 15:40:02.000000000 +0100
-@@ -1,5 +1,5 @@
- .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.23.
--.TH GRUB "8" "May 2005" "grub (GNU GRUB 0.97)" FSF
-+.TH GRUB "8" "June 2006" "grub (GNU GRUB 0.97)" FSF
- .SH NAME
- grub \- the grub shell
- .SH SYNOPSIS
-diff -uprN grub-0.97/docs/grub-install.8 grub/docs/grub-install.8
---- grub-0.97/docs/grub-install.8	2005-05-08 03:48:56.000000000 +0100
-+++ grub/docs/grub-install.8	2006-06-24 15:40:02.000000000 +0100
-@@ -1,5 +1,5 @@
- .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.23.
--.TH GRUB-INSTALL "8" "May 2005" "grub-install (GNU GRUB 0.97)" FSF
-+.TH GRUB-INSTALL "8" "June 2006" "grub-install (GNU GRUB 0.97)" FSF
- .SH NAME
- grub-install \- install GRUB on your drive
- .SH SYNOPSIS
-diff -uprN grub-0.97/docs/grub-md5-crypt.8 grub/docs/grub-md5-crypt.8
---- grub-0.97/docs/grub-md5-crypt.8	2005-05-08 03:48:56.000000000 +0100
-+++ grub/docs/grub-md5-crypt.8	2006-06-24 15:40:02.000000000 +0100
-@@ -1,5 +1,5 @@
- .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.23.
--.TH GRUB-MD5-CRYPT "8" "May 2005" "grub-md5-crypt (GNU GRUB )" FSF
-+.TH GRUB-MD5-CRYPT "8" "June 2006" "grub-md5-crypt (GNU GRUB )" FSF
- .SH NAME
- grub-md5-crypt \- Encrypt a password in MD5 format
- .SH SYNOPSIS
-diff -uprN grub-0.97/docs/grub-terminfo.8 grub/docs/grub-terminfo.8
---- grub-0.97/docs/grub-terminfo.8	2005-05-08 03:48:56.000000000 +0100
-+++ grub/docs/grub-terminfo.8	2006-06-24 15:40:02.000000000 +0100
-@@ -1,5 +1,5 @@
- .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.23.
--.TH GRUB-TERMINFO "8" "May 2005" "grub-terminfo (GNU GRUB 0.97)" FSF
-+.TH GRUB-TERMINFO "8" "June 2006" "grub-terminfo (GNU GRUB 0.97)" FSF
- .SH NAME
- grub-terminfo \- Generate a terminfo command from a terminfo name
- .SH SYNOPSIS
-diff -uprN grub-0.97/docs/grub.texi grub/docs/grub.texi
---- grub-0.97/docs/grub.texi	2005-05-08 03:59:59.000000000 +0100
-+++ grub/docs/grub.texi	2006-06-24 15:40:02.000000000 +0100
-@@ -2,22 +2,41 @@
- @c -*-texinfo-*-
- @c %**start of header
- @setfilename grub.info
--@settitle GRUB Manual
--@c %**end of header
--
- @include version.texi
--
-+@settitle GNU GRUB Manual @value{VERSION}
- @c Unify all our little indices for now.
- @syncodeindex fn cp
- @syncodeindex vr cp
- @syncodeindex ky cp
- @syncodeindex pg cp
- @syncodeindex tp cp
-+@c %**end of header
- 
- @footnotestyle separate
- @paragraphindent 3
- @finalout
- 
-+@copying
-+This manual is for GNU GRUB (version @value{VERSION},
-+@value{UPDATED}).
-+
-+Copyright @copyright{} 1999,2000,2001,2002,2004,2006 Free Software Foundation, Inc.
-+
-+@quotation
-+Permission is granted to copy, distribute and/or modify this document
-+under the terms of the GNU Free Documentation License, Version 1.2 or
-+any later version published by the Free Software Foundation; with no
-+Invariant Sections, with the Front-Cover Texts being ``A GNU Manual,''
-+and with the Back-Cover Texts as in (a) below.  A copy of the
-+license is included in the section entitled ``GNU Free Documentation
-+License.''
-+
-+(a) The FSF's Back-Cover Text is: ``You have freedom to copy and modify
-+this GNU Manual, like GNU software.  Copies published by the Free
-+Software Foundation raise funds for GNU development.''
-+@end quotation
-+@end copying
-+
- @dircategory Kernel
- @direntry
- * GRUB: (grub).                 The GRand Unified Bootloader
-@@ -34,53 +53,16 @@
- 
- @setchapternewpage odd
- 
--@ifinfo
--Copyright @copyright{} 1999,2000,2001,2002,2004 Free Software Foundation, Inc.
--
--Permission is granted to make and distribute verbatim copies of
--this manual provided the copyright notice and this permission notice
--are preserved on all copies.
--
--@ignore
--Permission is granted to process this file through TeX and print the
--results, provided the printed document carries a copying permission
--notice identical to this one except for the removal of this paragraph
--(this paragraph not being relevant to the printed manual).
--
--@end ignore
--
--Permission is granted to copy and distribute modified versions of this
--manual under the conditions for verbatim copying, provided also that
--the entire resulting derived work is distributed under the terms of a
--permission notice identical to this one.
--
--Permission is granted to copy and distribute translations of this manual
--into another language, under the above conditions for modified versions.
--@end ifinfo
--
- @titlepage
- @sp 10
--@title the GRUB manual
-+@title the GNU GRUB manual
- @subtitle The GRand Unified Bootloader, version @value{VERSION}, @value{UPDATED}.
- @author Gordon Matzigkeit
- @author Yoshinori K. Okuji
- @c The following two commands start the copyright page.
- @page
- @vskip 0pt plus 1filll
--Copyright @copyright{} 1999,2000,2001,2002,2004 Free Software Foundation, Inc.
--
--Permission is granted to make and distribute verbatim copies of
--this manual provided the copyright notice and this permission notice
--are preserved on all copies.
--Permission is granted to copy and distribute modified versions of this
--manual under the conditions for verbatim copying, provided that the entire
--resulting derived work is distributed under the terms of a permission
--notice identical to this one.
--
--Permission is granted to copy and distribute translations of this manual
--into another language, under the above conditions for modified versions,
--except that this permission notice may be stated in a translation approved
--by Free Software Foundation.
-+@insertcopying
- @end titlepage
- 
- @c Output the table of contents at the beginning.
-@@ -91,12 +73,14 @@ by Free Software Foundation.
- 
- @ifnottex
- @node Top
--@top GRUB manual
-+@top GNU GRUB manual
- 
- This is the documentation of GNU GRUB, the GRand Unified Bootloader,
- a flexible and powerful boot loader program for @sc{pc}s.
- 
- This edition documents version @value{VERSION}.
-+
-+@insertcopying
- @end ifnottex
- 
- @menu
-@@ -124,6 +108,7 @@ This edition documents version @value{VE
- * Reporting bugs::              Where you should send a bug report
- * Future::                      Some future plans on GRUB
- * Internals::                   Hacking GRUB
-+* Copying This Manual::         Copying This Manual
- * Index::
- @end menu
- 
-@@ -3965,6 +3950,16 @@ homepage}.
- @include internals.texi
- 
- 
-+@node Copying This Manual
-+@appendix Copying This Manual
-+
-+@menu
-+* GNU Free Documentation License::  License for copying this manual.
-+@end menu
-+
-+@include fdl.texi
-+
-+
- @node Index
- @unnumbered Index
- 
-diff -uprN grub-0.97/docs/Makefile.am grub/docs/Makefile.am
---- grub-0.97/docs/Makefile.am	2003-07-09 12:45:35.000000000 +0100
-+++ grub/docs/Makefile.am	2006-06-24 15:40:02.000000000 +0100
-@@ -1,5 +1,5 @@
- info_TEXINFOS = grub.texi multiboot.texi
--grub_TEXINFOS = internals.texi
-+grub_TEXINFOS = internals.texi fdl.texi
- EXAMPLES = boot.S kernel.c multiboot.h
- multiboot_TEXINFOS = boot.S.texi kernel.c.texi multiboot.h.texi
- man_MANS = grub.8 mbchk.1 grub-install.8 grub-md5-crypt.8 grub-terminfo.8
-diff -uprN grub-0.97/docs/Makefile.in grub/docs/Makefile.in
---- grub-0.97/docs/Makefile.in	2005-05-08 03:42:34.000000000 +0100
-+++ grub/docs/Makefile.in	2006-06-24 15:40:02.000000000 +0100
-@@ -202,7 +202,7 @@ sharedstatedir = @sharedstatedir@
- sysconfdir = @sysconfdir@
- target_alias = @target_alias@
- info_TEXINFOS = grub.texi multiboot.texi
--grub_TEXINFOS = internals.texi
-+grub_TEXINFOS = internals.texi fdl.texi
- EXAMPLES = boot.S kernel.c multiboot.h
- multiboot_TEXINFOS = boot.S.texi kernel.c.texi multiboot.h.texi
- man_MANS = grub.8 mbchk.1 grub-install.8 grub-md5-crypt.8 grub-terminfo.8
-diff -uprN grub-0.97/docs/mbchk.1 grub/docs/mbchk.1
---- grub-0.97/docs/mbchk.1	2005-05-08 03:48:56.000000000 +0100
-+++ grub/docs/mbchk.1	2006-06-24 15:40:02.000000000 +0100
-@@ -1,5 +1,5 @@
- .\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.23.
--.TH MBCHK "1" "May 2005" "mbchk (GNU GRUB 0.97)" FSF
-+.TH MBCHK "1" "June 2006" "mbchk (GNU GRUB 0.97)" FSF
- .SH NAME
- mbchk \- check the format of a Multiboot kernel
- .SH SYNOPSIS
-diff -uprN grub-0.97/docs/multiboot.texi grub/docs/multiboot.texi
---- grub-0.97/docs/multiboot.texi	2003-07-09 12:45:36.000000000 +0100
-+++ grub/docs/multiboot.texi	2006-06-24 15:40:02.000000000 +0100
-@@ -1,32 +1,28 @@
- \input texinfo @c -*-texinfo-*-
--@c -*-texinfo-*-
- @c %**start of header
- @setfilename multiboot.info
--@settitle Multiboot Specification
--@c %**end of header
--
-+@set VERSION 0.6.95
-+@settitle Multiboot Specification version @value{VERSION}
- @c Unify all our little indices for now.
- @syncodeindex fn cp
- @syncodeindex vr cp
- @syncodeindex ky cp
- @syncodeindex pg cp
- @syncodeindex tp cp
-+@c %**end of header
- 
- @footnotestyle separate
- @paragraphindent 3
- @finalout
- 
-+@copying
-+Copyright @copyright{} 1995,96 Bryan Ford <baford@@cs.utah.edu>
- 
--@dircategory Kernel
--@direntry
--* Multiboot Specification: (multiboot).		Multiboot Specification.
--@end direntry
-+Copyright @copyright{} 1995,96 Erich Stefan Boleyn <erich@@uruk.org>
- 
--@ifinfo
--Copyright @copyright{} 1995, 96 Bryan Ford <baford@@cs.utah.edu>
--Copyright @copyright{} 1995, 96 Erich Stefan Boleyn <erich@@uruk.org>
--Copyright @copyright{} 1999, 2000, 2001, 2002 Free Software Foundation, Inc.
-+Copyright @copyright{} 1999,2000,2001,2002,2005,2006 Free Software Foundation, Inc.
- 
-+@quotation
- Permission is granted to make and distribute verbatim copies of
- this manual provided the copyright notice and this permission notice
- are preserved on all copies.
-@@ -36,7 +32,6 @@ Permission is granted to process this fi
- results, provided the printed document carries a copying permission
- notice identical to this one except for the removal of this paragraph
- (this paragraph not being relevant to the printed manual).
--
- @end ignore
- 
- Permission is granted to copy and distribute modified versions of this
-@@ -45,31 +40,23 @@ the entire resulting derived work is dis
- permission notice identical to this one.
- 
- Permission is granted to copy and distribute translations of this manual
--into another language, under the above conditions for modified versions.
--@end ifinfo
-+into another language, under the above conditions for modified
-+versions.
-+@end quotation
-+@end copying
-+
-+@dircategory Kernel
-+@direntry
-+* Multiboot Specification: (multiboot).		Multiboot Specification.
-+@end direntry
- 
- @titlepage
- @sp 10
--@title The Multiboot Specification
-+@title The Multiboot Specification version @value{VERSION}
- @author Yoshinori K. Okuji, Bryan Ford, Erich Stefan Boleyn, Kunihiro Ishiguro
- @page
--
- @vskip 0pt plus 1filll
--Copyright @copyright{} 1995, 96 Bryan Ford <baford@@cs.utah.edu>
--Copyright @copyright{} 1995, 96 Erich Stefan Boleyn <erich@@uruk.org>
--Copyright @copyright{} 1999, 2000, 2001, 2002 Free Software Foundation, Inc.
--
--Permission is granted to make and distribute verbatim copies of
--this manual provided the copyright notice and this permission notice
--are preserved on all copies.
--
--Permission is granted to copy and distribute modified versions of this
--manual under the conditions for verbatim copying, provided also that
--the entire resulting derived work is distributed under the terms of a
--permission notice identical to this one.
--
--Permission is granted to copy and distribute translations of this manual
--into another language, under the above conditions for modified versions.
-+@insertcopying
- @end titlepage
- 
- @finalout
-@@ -80,7 +67,9 @@ into another language, under the above c
- @top Multiboot Specification
- 
- This file documents Multiboot Specification, the proposal for the boot
--sequence standard. This edition documents version 0.6.93.
-+sequence standard. This edition documents version @value{VERSION}.
-+
-+@insertcopying
- @end ifnottex
- 
- @menu
-@@ -426,7 +415,7 @@ mode table (@pxref{Boot information form
- kernel.
- 
- If bit 16 in the @samp{flags} word is set, then the fields at offsets
--8-24 in the Multiboot header are valid, and the boot loader should use
-+12-28 in the Multiboot header are valid, and the boot loader should use
- them instead of the fields in the actual executable header to calculate
- where to load the OS image. This information does not need to be
- provided if the kernel image is in @sc{elf} format, but it @emph{must}
-@@ -677,7 +666,7 @@ follows:
- @example
- @group
- +-------+-------+-------+-------+
--| drive | part1 | part2 | part3 |
-+| part3 | part2 | part1 | drive |
- +-------+-------+-------+-------+
- @end group
- @end example
-@@ -1197,6 +1186,17 @@ Rewritten, using more strict words.
- @item
- The maintainer changes to the GNU GRUB maintainer team
- @email{bug-grub@@gnu.org}, from Bryan Ford and Erich Stefan Boleyn.
-+
-+@item
-+The byte order of the @samp{boot_device} in Multiboot information is
-+reversed. This was a mistake.
-+
-+@item
-+The offset of the address fields were wrong.
-+
-+@item
-+The format is adapted to a newer Texinfo, and the version number is
-+specified more explicitly in the title.
- @end itemize
- 
- @item 0.6
 diff -uprN grub-0.97/grub/asmstub.c grub/grub/asmstub.c
 --- grub-0.97/grub/asmstub.c	2005-02-16 20:45:14.000000000 +0000
 +++ grub/grub/asmstub.c	2008-03-28 13:22:28.000000000 +0000
diff --git a/stubdom/grub.patches/20print_func.diff b/stubdom/grub.patches/20print_func.diff
index ec9da0ea4e..71ad042ac2 100644
--- a/stubdom/grub.patches/20print_func.diff
+++ b/stubdom/grub.patches/20print_func.diff
@@ -13,34 +13,6 @@ Debian Status Following:
    Added by: Otavio Salvador
        Date: 2006-01-05
 
-diff -Nur grub-0.97-bkp/docs/grub.texi grub-0.97/docs/grub.texi
---- grub-0.97-bkp/docs/grub.texi	2006-01-05 10:59:05.564347912 -0200
-+++ grub-0.97/docs/grub.texi	2006-01-05 11:18:59.033912960 -0200
-@@ -2685,6 +2685,7 @@
- * module::                      Load a module
- * modulenounzip::               Load a module without decompression
- * pause::                       Wait for a key press
-+* print::                       Print a message
- * quit::                        Exit from the grub shell
- * reboot::                      Reboot your computer
- * read::                        Read data from memory
-@@ -3091,6 +3092,16 @@
- @end deffn
- 
- 
-+@node print
-+@subsection print
-+
-+@deffn Command print message @dots{}
-+Print the @var{message}. Note that placing @key{^G} (ASCII code 7) in the
-+message will cause the speaker to emit the standard beep sound, which is
-+useful for visually impaired people.
-+@end deffn
-+
-+
- @node quit
- @subsection quit
- 
 diff -Nur grub-0.97-bkp/stage2/builtins.c grub-0.97/stage2/builtins.c
 --- grub-0.97-bkp/stage2/builtins.c	2006-01-05 10:59:05.550350040 -0200
 +++ grub-0.97/stage2/builtins.c	2006-01-05 11:19:28.422445224 -0200
diff --git a/stubdom/grub.patches/61btrfs.diff b/stubdom/grub.patches/61btrfs.diff
index c831a107d3..ae8f866e50 100644
--- a/stubdom/grub.patches/61btrfs.diff
+++ b/stubdom/grub.patches/61btrfs.diff
@@ -27,17 +27,6 @@ diff -up grub-upstream.wip/configure.ac.btrfs grub-upstream.wip/configure.ac
  AC_ARG_ENABLE(vstafs,
    [  --disable-vstafs        disable VSTa FS support in Stage 2])
  
-diff -up grub-upstream.wip/docs/grub.texi.btrfs grub-upstream.wip/docs/grub.texi
---- grub-upstream.wip/docs/grub.texi.btrfs	2012-03-20 05:06:49.000000000 +0000
-+++ grub-upstream.wip/docs/grub.texi	2012-03-20 05:07:09.000000000 +0000
-@@ -1761,6 +1761,7 @@ itself. Usually, this is put in a filesy
- @itemx jfs_stage1_5
- @itemx minix_stage1_5
- @itemx reiserfs_stage1_5
-+@itemx btrfs_stage1_5
- @itemx vstafs_stage1_5
- @itemx xfs_stage1_5
- 
 diff -up grub-upstream.wip/grub/Makefile.am.btrfs grub-upstream.wip/grub/Makefile.am
 --- grub-upstream.wip/grub/Makefile.am.btrfs	2005-02-02 20:38:19.000000000 +0000
 +++ grub-upstream.wip/grub/Makefile.am	2012-03-20 05:07:09.000000000 +0000
-- 
2.30.2

